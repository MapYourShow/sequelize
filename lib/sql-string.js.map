{
  "version": 3,
  "sources": ["../src/sql-string.js"],
  "sourcesContent": ["'use strict';\r\n\r\nconst dataTypes = require('./data-types');\r\nconst { logger } = require('./utils/logger');\r\n\r\nexport function arrayToList(array, timeZone, dialect, format) {\r\n  return array.reduce((sql, val, i) => {\r\n    if (i !== 0) {\r\n      sql += ', ';\r\n    }\r\n\r\n    if (Array.isArray(val)) {\r\n      sql += `(${arrayToList(val, timeZone, dialect, format)})`;\r\n    } else {\r\n      sql += escape(val, timeZone, dialect, format);\r\n    }\r\n\r\n    return sql;\r\n  }, '');\r\n}\r\n\r\nexport function escape(val, timeZone, dialect, format) {\r\n  let prependN = false;\r\n  if (val === undefined || val === null) {\r\n    // There are cases in Db2 for i where 'NULL' isn't accepted, such as\r\n    // comparison with a WHERE() statement. In those cases, we have to cast.\r\n    if (dialect === 'ibmi' && format) {\r\n      return 'cast(NULL as int)';\r\n    }\r\n\r\n    return 'NULL';\r\n  }\r\n\r\n  switch (typeof val) {\r\n    case 'boolean':\r\n    // SQLite doesn't have true/false support. MySQL aliases true/false to 1/0\r\n    // for us. Postgres actually has a boolean type with true/false literals,\r\n    // but sequelize doesn't use it yet.\r\n      if (['sqlite', 'mssql', 'ibmi'].includes(dialect)) {\r\n        return Number(Boolean(val));\r\n      }\r\n\r\n      return (Boolean(val)).toString();\r\n    case 'number':\r\n    case 'bigint':\r\n      return val.toString();\r\n    case 'string':\r\n    // In mssql, prepend N to all quoted vals which are originally a string (for\r\n    // unicode compatibility)\r\n      prependN = dialect === 'mssql';\r\n      break;\r\n  }\r\n\r\n  if (val instanceof Date) {\r\n    val = dataTypes[dialect].DATE.prototype.stringify(val, { timezone: timeZone });\r\n  }\r\n\r\n  if (Buffer.isBuffer(val)) {\r\n    if (dialect === 'ibmi') {\r\n      return dataTypes[dialect].STRING.prototype.stringify(val);\r\n    }\r\n\r\n    if (dataTypes[dialect].BLOB) {\r\n      return dataTypes[dialect].BLOB.prototype.stringify(val);\r\n    }\r\n\r\n    return dataTypes.BLOB.prototype.stringify(val);\r\n  }\r\n\r\n  if (Array.isArray(val)) {\r\n    const partialEscape = escVal => escape(escVal, timeZone, dialect, format);\r\n    if (dialect === 'postgres' && !format) {\r\n      return dataTypes.ARRAY.prototype.stringify(val, { escape: partialEscape });\r\n    }\r\n\r\n    return arrayToList(val, timeZone, dialect, format);\r\n  }\r\n\r\n  if (!val.replace) {\r\n    throw new Error(`Invalid value ${logger.inspect(val)}`);\r\n  }\r\n\r\n  if (['postgres', 'sqlite', 'mssql', 'snowflake', 'db2', 'ibmi'].includes(dialect)) {\r\n    // http://www.postgresql.org/docs/8.2/static/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS\r\n    // http://stackoverflow.com/q/603572/130598\r\n    val = val.replace(/'/g, '\\'\\'');\r\n\r\n    if (dialect === 'postgres') {\r\n      // null character is not allowed in Postgres\r\n      val = val.replace(/\\0/g, '\\\\0');\r\n    }\r\n  } else {\r\n\r\n    // eslint-disable-next-line no-control-regex -- \\u001A is intended to be in this regex\r\n    val = val.replace(/[\\b\\0\\t\\n\\r\\u001A\"'\\\\]/g, s => {\r\n      switch (s) {\r\n        case '\\0': return '\\\\0';\r\n        case '\\n': return '\\\\n';\r\n        case '\\r': return '\\\\r';\r\n        case '\\b': return '\\\\b';\r\n        case '\\t': return '\\\\t';\r\n        case '\\u001A': return '\\\\Z';\r\n        default: return `\\\\${s}`;\r\n      }\r\n    });\r\n  }\r\n\r\n  return `${(prependN ? 'N\\'' : '\\'') + val}'`;\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,MAAM,YAAY,QAAQ,cAAc;AACxC,MAAM,EAAE,WAAW,QAAQ,gBAAgB;AAEpC,qBAAqB,OAAO,UAAU,SAAS,QAAQ;AAC5D,SAAO,MAAM,OAAO,CAAC,KAAK,KAAK,MAAM;AACnC,QAAI,MAAM,GAAG;AACX,aAAO;AAAA,IACT;AAEA,QAAI,MAAM,QAAQ,GAAG,GAAG;AACtB,aAAO,IAAI,YAAY,KAAK,UAAU,SAAS,MAAM;AAAA,IACvD,OAAO;AACL,aAAO,OAAO,KAAK,UAAU,SAAS,MAAM;AAAA,IAC9C;AAEA,WAAO;AAAA,EACT,GAAG,EAAE;AACP;AAEO,gBAAgB,KAAK,UAAU,SAAS,QAAQ;AACrD,MAAI,WAAW;AACf,MAAI,QAAQ,UAAa,QAAQ,MAAM;AAGrC,QAAI,YAAY,UAAU,QAAQ;AAChC,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAEA,UAAQ,OAAO;AAAA,SACR;AAIH,UAAI,CAAC,UAAU,SAAS,MAAM,EAAE,SAAS,OAAO,GAAG;AACjD,eAAO,OAAO,QAAQ,GAAG,CAAC;AAAA,MAC5B;AAEA,aAAQ,QAAQ,GAAG,EAAG,SAAS;AAAA,SAC5B;AAAA,SACA;AACH,aAAO,IAAI,SAAS;AAAA,SACjB;AAGH,iBAAW,YAAY;AACvB;AAAA;AAGJ,MAAI,eAAe,MAAM;AACvB,UAAM,UAAU,SAAS,KAAK,UAAU,UAAU,KAAK,EAAE,UAAU,SAAS,CAAC;AAAA,EAC/E;AAEA,MAAI,OAAO,SAAS,GAAG,GAAG;AACxB,QAAI,YAAY,QAAQ;AACtB,aAAO,UAAU,SAAS,OAAO,UAAU,UAAU,GAAG;AAAA,IAC1D;AAEA,QAAI,UAAU,SAAS,MAAM;AAC3B,aAAO,UAAU,SAAS,KAAK,UAAU,UAAU,GAAG;AAAA,IACxD;AAEA,WAAO,UAAU,KAAK,UAAU,UAAU,GAAG;AAAA,EAC/C;AAEA,MAAI,MAAM,QAAQ,GAAG,GAAG;AACtB,UAAM,gBAAgB,YAAU,OAAO,QAAQ,UAAU,SAAS,MAAM;AACxE,QAAI,YAAY,cAAc,CAAC,QAAQ;AACrC,aAAO,UAAU,MAAM,UAAU,UAAU,KAAK,EAAE,QAAQ,cAAc,CAAC;AAAA,IAC3E;AAEA,WAAO,YAAY,KAAK,UAAU,SAAS,MAAM;AAAA,EACnD;AAEA,MAAI,CAAC,IAAI,SAAS;AAChB,UAAM,IAAI,MAAM,iBAAiB,OAAO,QAAQ,GAAG,GAAG;AAAA,EACxD;AAEA,MAAI,CAAC,YAAY,UAAU,SAAS,aAAa,OAAO,MAAM,EAAE,SAAS,OAAO,GAAG;AAGjF,UAAM,IAAI,QAAQ,MAAM,IAAM;AAE9B,QAAI,YAAY,YAAY;AAE1B,YAAM,IAAI,QAAQ,OAAO,KAAK;AAAA,IAChC;AAAA,EACF,OAAO;AAGL,UAAM,IAAI,QAAQ,2BAA2B,OAAK;AAChD,cAAQ;AAAA,aACD;AAAM,iBAAO;AAAA,aACb;AAAM,iBAAO;AAAA,aACb;AAAM,iBAAO;AAAA,aACb;AAAM,iBAAO;AAAA,aACb;AAAM,iBAAO;AAAA,aACb;AAAU,iBAAO;AAAA;AACb,iBAAO,KAAK;AAAA;AAAA,IAEzB,CAAC;AAAA,EACH;AAEA,SAAO,GAAI,YAAW,OAAQ,OAAQ;AACxC;",
  "names": []
}
