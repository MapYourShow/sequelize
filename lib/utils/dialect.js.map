{
  "version": 3,
  "sources": ["../../src/utils/dialect.ts"],
  "sourcesContent": ["import isPlainObject from 'lodash/isPlainObject';\r\n// eslint-disable-next-line import/order -- caused by temporarily mixing require with import\r\nimport { v1 as uuidv1, v4 as uuidv4 } from 'uuid';\r\n\r\nconst DataTypes = require('../data-types');\r\n\r\nconst dialectsSupportingMilliseconds = new Set([\r\n  'mariadb',\r\n  'mysql',\r\n  'postgres',\r\n  'sqlite',\r\n  'mssql',\r\n  'db2',\r\n  'ibmi',\r\n]);\r\n\r\n// TODO: instead of receiving a dialect *name* here, require the actual AbstractDialect subclass\r\n//  and add a flag on AbstractDialect.supports to determine if the date should include milliseconds.\r\nexport function now(dialect: string): Date {\r\n  const d = new Date();\r\n  if (!dialectsSupportingMilliseconds.has(dialect)) {\r\n    d.setMilliseconds(0);\r\n  }\r\n\r\n  return d;\r\n}\r\n\r\nexport function toDefaultValue(value: unknown, dialect: string): unknown {\r\n  if (typeof value === 'function') {\r\n    const tmp = value();\r\n    if (tmp instanceof DataTypes.ABSTRACT) {\r\n      return tmp.toSql();\r\n    }\r\n\r\n    return tmp;\r\n  }\r\n\r\n  if (value instanceof DataTypes.UUIDV1) {\r\n    return uuidv1();\r\n  }\r\n\r\n  if (value instanceof DataTypes.UUIDV4) {\r\n    return uuidv4();\r\n  }\r\n\r\n  if (value instanceof DataTypes.NOW) {\r\n    return now(dialect);\r\n  }\r\n\r\n  if (Array.isArray(value)) {\r\n    return [...value];\r\n  }\r\n\r\n  if (isPlainObject(value)) {\r\n    return { ...(value as object) };\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\n// Note: Use the `quoteIdentifier()` and `escape()` methods on the\r\n// `QueryInterface` instead for more portable code.\r\nexport const TICK_CHAR = '`';\r\n\r\nexport function addTicks(s: string, tickChar: string = TICK_CHAR): string {\r\n  return tickChar + removeTicks(s, tickChar) + tickChar;\r\n}\r\n\r\nexport function removeTicks(s: string, tickChar: string = TICK_CHAR): string {\r\n  return s.replace(new RegExp(tickChar, 'g'), '');\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAA0B;AAE1B,kBAA2C;AAE3C,MAAM,YAAY,QAAQ,eAAe;AAEzC,MAAM,iCAAiC,oBAAI,IAAI;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAIM,aAAa,SAAuB;AACzC,QAAM,IAAI,IAAI,KAAK;AACnB,MAAI,CAAC,+BAA+B,IAAI,OAAO,GAAG;AAChD,MAAE,gBAAgB,CAAC;AAAA,EACrB;AAEA,SAAO;AACT;AAEO,wBAAwB,OAAgB,SAA0B;AACvE,MAAI,OAAO,UAAU,YAAY;AAC/B,UAAM,MAAM,MAAM;AAClB,QAAI,eAAe,UAAU,UAAU;AACrC,aAAO,IAAI,MAAM;AAAA,IACnB;AAEA,WAAO;AAAA,EACT;AAEA,MAAI,iBAAiB,UAAU,QAAQ;AACrC,WAAO,oBAAO;AAAA,EAChB;AAEA,MAAI,iBAAiB,UAAU,QAAQ;AACrC,WAAO,oBAAO;AAAA,EAChB;AAEA,MAAI,iBAAiB,UAAU,KAAK;AAClC,WAAO,IAAI,OAAO;AAAA,EACpB;AAEA,MAAI,MAAM,QAAQ,KAAK,GAAG;AACxB,WAAO,CAAC,GAAG,KAAK;AAAA,EAClB;AAEA,MAAI,kCAAc,KAAK,GAAG;AACxB,WAAO,mBAAM;AAAA,EACf;AAEA,SAAO;AACT;AAIO,MAAM,YAAY;AAElB,kBAAkB,GAAW,WAAmB,WAAmB;AACxE,SAAO,WAAW,YAAY,GAAG,QAAQ,IAAI;AAC/C;AAEO,qBAAqB,GAAW,WAAmB,WAAmB;AAC3E,SAAO,EAAE,QAAQ,IAAI,OAAO,UAAU,GAAG,GAAG,EAAE;AAChD;",
  "names": []
}
