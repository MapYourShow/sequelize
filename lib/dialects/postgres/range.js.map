{
  "version": 3,
  "sources": ["../../../src/dialects/postgres/range.js"],
  "sourcesContent": ["'use strict';\r\n\r\nconst _ = require('lodash');\r\n\r\nfunction stringifyRangeBound(bound) {\r\n  if (bound === null) {\r\n    return '';\r\n  }\r\n\r\n  if (bound === Number.POSITIVE_INFINITY || bound === Number.NEGATIVE_INFINITY) {\r\n    return bound.toString().toLowerCase();\r\n  }\r\n\r\n  return JSON.stringify(bound);\r\n}\r\n\r\nfunction parseRangeBound(bound, parseType) {\r\n  if (!bound) {\r\n    return null;\r\n  }\r\n\r\n  if (bound === 'infinity') {\r\n    return Number.POSITIVE_INFINITY;\r\n  }\r\n\r\n  if (bound === '-infinity') {\r\n    return Number.NEGATIVE_INFINITY;\r\n  }\r\n\r\n  return parseType(bound);\r\n\r\n}\r\n\r\nexport function stringify(data) {\r\n  if (data === null) {\r\n    return null;\r\n  }\r\n\r\n  if (!Array.isArray(data)) {\r\n    throw new TypeError('range must be an array');\r\n  }\r\n\r\n  if (data.length === 0) {\r\n    return 'empty';\r\n  }\r\n\r\n  if (data.length !== 2) {\r\n    throw new Error('range array length must be 0 (empty) or 2 (lower and upper bounds)');\r\n  }\r\n\r\n  if (Object.prototype.hasOwnProperty.call(data, 'inclusive')) {\r\n    if (data.inclusive === false) {\r\n      data.inclusive = [false, false];\r\n    } else if (!data.inclusive) {\r\n      data.inclusive = [true, false];\r\n    } else if (data.inclusive === true) {\r\n      data.inclusive = [true, true];\r\n    }\r\n  } else {\r\n    data.inclusive = [true, false];\r\n  }\r\n\r\n  _.each(data, (value, index) => {\r\n    if (_.isObject(value)) {\r\n      if (Object.prototype.hasOwnProperty.call(value, 'inclusive')) {\r\n        data.inclusive[index] = Boolean(value.inclusive);\r\n      }\r\n\r\n      if (Object.prototype.hasOwnProperty.call(value, 'value')) {\r\n        data[index] = value.value;\r\n      }\r\n    }\r\n  });\r\n\r\n  const lowerBound = stringifyRangeBound(data[0]);\r\n  const upperBound = stringifyRangeBound(data[1]);\r\n\r\n  return `${(data.inclusive[0] ? '[' : '(') + lowerBound},${upperBound}${data.inclusive[1] ? ']' : ')'}`;\r\n}\r\n\r\nexport function parse(value, parser) {\r\n  if (value === null) {\r\n    return null;\r\n  }\r\n\r\n  if (value === 'empty') {\r\n    return [];\r\n  }\r\n\r\n  // eslint-disable-next-line unicorn/prefer-string-slice -- TODO\r\n  let result = value\r\n    .substring(1, value.length - 1)\r\n    .split(',', 2);\r\n\r\n  if (result.length !== 2) {\r\n    return value;\r\n  }\r\n\r\n  result = result.map((item, index) => {\r\n    return {\r\n      value: parseRangeBound(item, parser),\r\n      inclusive: index === 0 ? value[0] === '[' : value[value.length - 1] === ']',\r\n    };\r\n  });\r\n\r\n  return result;\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,MAAM,IAAI,QAAQ,QAAQ;AAE1B,6BAA6B,OAAO;AAClC,MAAI,UAAU,MAAM;AAClB,WAAO;AAAA,EACT;AAEA,MAAI,UAAU,OAAO,qBAAqB,UAAU,OAAO,mBAAmB;AAC5E,WAAO,MAAM,SAAS,EAAE,YAAY;AAAA,EACtC;AAEA,SAAO,KAAK,UAAU,KAAK;AAC7B;AAEA,yBAAyB,OAAO,WAAW;AACzC,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,EACT;AAEA,MAAI,UAAU,YAAY;AACxB,WAAO,OAAO;AAAA,EAChB;AAEA,MAAI,UAAU,aAAa;AACzB,WAAO,OAAO;AAAA,EAChB;AAEA,SAAO,UAAU,KAAK;AAExB;AAEO,mBAAmB,MAAM;AAC9B,MAAI,SAAS,MAAM;AACjB,WAAO;AAAA,EACT;AAEA,MAAI,CAAC,MAAM,QAAQ,IAAI,GAAG;AACxB,UAAM,IAAI,UAAU,wBAAwB;AAAA,EAC9C;AAEA,MAAI,KAAK,WAAW,GAAG;AACrB,WAAO;AAAA,EACT;AAEA,MAAI,KAAK,WAAW,GAAG;AACrB,UAAM,IAAI,MAAM,oEAAoE;AAAA,EACtF;AAEA,MAAI,OAAO,UAAU,eAAe,KAAK,MAAM,WAAW,GAAG;AAC3D,QAAI,KAAK,cAAc,OAAO;AAC5B,WAAK,YAAY,CAAC,OAAO,KAAK;AAAA,IAChC,WAAW,CAAC,KAAK,WAAW;AAC1B,WAAK,YAAY,CAAC,MAAM,KAAK;AAAA,IAC/B,WAAW,KAAK,cAAc,MAAM;AAClC,WAAK,YAAY,CAAC,MAAM,IAAI;AAAA,IAC9B;AAAA,EACF,OAAO;AACL,SAAK,YAAY,CAAC,MAAM,KAAK;AAAA,EAC/B;AAEA,IAAE,KAAK,MAAM,CAAC,OAAO,UAAU;AAC7B,QAAI,EAAE,SAAS,KAAK,GAAG;AACrB,UAAI,OAAO,UAAU,eAAe,KAAK,OAAO,WAAW,GAAG;AAC5D,aAAK,UAAU,SAAS,QAAQ,MAAM,SAAS;AAAA,MACjD;AAEA,UAAI,OAAO,UAAU,eAAe,KAAK,OAAO,OAAO,GAAG;AACxD,aAAK,SAAS,MAAM;AAAA,MACtB;AAAA,IACF;AAAA,EACF,CAAC;AAED,QAAM,aAAa,oBAAoB,KAAK,EAAE;AAC9C,QAAM,aAAa,oBAAoB,KAAK,EAAE;AAE9C,SAAO,GAAI,MAAK,UAAU,KAAK,MAAM,OAAO,cAAc,aAAa,KAAK,UAAU,KAAK,MAAM;AACnG;AAEO,eAAe,OAAO,QAAQ;AACnC,MAAI,UAAU,MAAM;AAClB,WAAO;AAAA,EACT;AAEA,MAAI,UAAU,SAAS;AACrB,WAAO,CAAC;AAAA,EACV;AAGA,MAAI,SAAS,MACV,UAAU,GAAG,MAAM,SAAS,CAAC,EAC7B,MAAM,KAAK,CAAC;AAEf,MAAI,OAAO,WAAW,GAAG;AACvB,WAAO;AAAA,EACT;AAEA,WAAS,OAAO,IAAI,CAAC,MAAM,UAAU;AACnC,WAAO;AAAA,MACL,OAAO,gBAAgB,MAAM,MAAM;AAAA,MACnC,WAAW,UAAU,IAAI,MAAM,OAAO,MAAM,MAAM,MAAM,SAAS,OAAO;AAAA,IAC1E;AAAA,EACF,CAAC;AAED,SAAO;AACT;",
  "names": []
}
