{
  "version": 3,
  "sources": ["../../../src/dialects/abstract/query-interface.js"],
  "sourcesContent": ["'use strict';\r\n\r\nimport { assertNoReservedBind, combineBinds } from '../../utils/sql';\r\n\r\nconst _ = require('lodash');\r\n\r\nconst Utils = require('../../utils');\r\nconst DataTypes = require('../../data-types');\r\nconst { Transaction } = require('../../transaction');\r\nconst { QueryTypes } = require('../../query-types');\r\n\r\n/**\r\n * The interface that Sequelize uses to talk to all databases\r\n */\r\nexport class QueryInterface {\r\n  constructor(sequelize, queryGenerator) {\r\n    this.sequelize = sequelize;\r\n    this.queryGenerator = queryGenerator;\r\n  }\r\n\r\n  /**\r\n   * Create a database\r\n   *\r\n   * @param {string} database  Database name to create\r\n   * @param {object} [options] Query options\r\n   * @param {string} [options.charset] Database default character set, MYSQL only\r\n   * @param {string} [options.collate] Database default collation\r\n   * @param {string} [options.encoding] Database default character set, PostgreSQL only\r\n   * @param {string} [options.ctype] Database character classification, PostgreSQL only\r\n   * @param {string} [options.template] The name of the template from which to create the new database, PostgreSQL only\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async createDatabase(database, options) {\r\n    options = options || {};\r\n    const sql = this.queryGenerator.createDatabaseQuery(database, options);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Drop a database\r\n   *\r\n   * @param {string} database  Database name to drop\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropDatabase(database, options) {\r\n    options = options || {};\r\n    const sql = this.queryGenerator.dropDatabaseQuery(database);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Create a schema\r\n   *\r\n   * @param {string} schema    Schema name to create\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async createSchema(schema, options) {\r\n    options = options || {};\r\n    const sql = this.queryGenerator.createSchema(schema);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Drop a schema\r\n   *\r\n   * @param {string} schema    Schema name to drop\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropSchema(schema, options) {\r\n    options = options || {};\r\n    const query = this.queryGenerator.dropSchema(schema);\r\n\r\n    let sql;\r\n    if (typeof query === 'object') {\r\n      options.bind = query.bind;\r\n      sql = query.query;\r\n    } else {\r\n      sql = query;\r\n    }\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Drop all schemas\r\n   *\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropAllSchemas(options) {\r\n    options = options || {};\r\n\r\n    if (!this.queryGenerator._dialect.supports.schemas) {\r\n      return this.sequelize.drop(options);\r\n    }\r\n\r\n    const schemas = await this.showAllSchemas(options);\r\n\r\n    return Promise.all(schemas.map(schemaName => this.dropSchema(schemaName, options)));\r\n  }\r\n\r\n  /**\r\n   * Show all schemas\r\n   *\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise<Array>}\r\n   */\r\n  async showAllSchemas(options) {\r\n    options = {\r\n      ...options,\r\n      raw: true,\r\n      type: this.sequelize.QueryTypes.SELECT,\r\n    };\r\n\r\n    const showSchemasSql = this.queryGenerator.showSchemasQuery(options);\r\n\r\n    const schemaNames = await this.sequelize.queryRaw(showSchemasSql, options);\r\n\r\n    return schemaNames.flatMap(value => (value.schema_name ? value.schema_name : value));\r\n  }\r\n\r\n  /**\r\n   * Return database version\r\n   *\r\n   * @param {object}    [options]      Query options\r\n   * @param {QueryType} [options.type] Query type\r\n   *\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  async databaseVersion(options) {\r\n    return await this.sequelize.queryRaw(\r\n      this.queryGenerator.versionQuery(),\r\n      { ...options, type: QueryTypes.VERSION },\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Create a table with given set of attributes\r\n   *\r\n   * ```js\r\n   * queryInterface.createTable(\r\n   *   'nameOfTheNewTable',\r\n   *   {\r\n   *     id: {\r\n   *       type: DataTypes.INTEGER,\r\n   *       primaryKey: true,\r\n   *       autoIncrement: true\r\n   *     },\r\n   *     createdAt: {\r\n   *       type: DataTypes.DATE\r\n   *     },\r\n   *     updatedAt: {\r\n   *       type: DataTypes.DATE\r\n   *     },\r\n   *     attr1: DataTypes.STRING,\r\n   *     attr2: DataTypes.INTEGER,\r\n   *     attr3: {\r\n   *       type: DataTypes.BOOLEAN,\r\n   *       defaultValue: false,\r\n   *       allowNull: false\r\n   *     },\r\n   *     //foreign key usage\r\n   *     attr4: {\r\n   *       type: DataTypes.INTEGER,\r\n   *       references: {\r\n   *         model: 'another_table_name',\r\n   *         key: 'id'\r\n   *       },\r\n   *       onUpdate: 'cascade',\r\n   *       onDelete: 'cascade'\r\n   *     }\r\n   *   },\r\n   *   {\r\n   *     engine: 'MYISAM',    // default: 'InnoDB'\r\n   *     charset: 'latin1',   // default: null\r\n   *     schema: 'public',    // default: public, PostgreSQL only.\r\n   *     comment: 'my table', // comment for table\r\n   *     collate: 'latin1_danish_ci' // collation, MYSQL only\r\n   *   }\r\n   * )\r\n   * ```\r\n   *\r\n   * @param {string} tableName  Name of table to create\r\n   * @param {object} attributes Object representing a list of table attributes to create\r\n   * @param {object} [options] create table and query options\r\n   * @param {Model}  [model] model class\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async createTable(tableName, attributes, options, model) {\r\n    let sql = '';\r\n\r\n    options = { ...options };\r\n\r\n    if (options && options.uniqueKeys) {\r\n      _.forOwn(options.uniqueKeys, uniqueKey => {\r\n        if (uniqueKey.customIndex === undefined) {\r\n          uniqueKey.customIndex = true;\r\n        }\r\n      });\r\n    }\r\n\r\n    if (model) {\r\n      options.uniqueKeys = options.uniqueKeys || model.uniqueKeys;\r\n    }\r\n\r\n    attributes = _.mapValues(\r\n      attributes,\r\n      attribute => this.sequelize.normalizeAttribute(attribute),\r\n    );\r\n\r\n    // Postgres requires special SQL commands for ENUM/ENUM[]\r\n    await this.ensureEnums(tableName, attributes, options, model);\r\n\r\n    if (\r\n      !tableName.schema\r\n      && (options.schema || Boolean(model) && model._schema)\r\n    ) {\r\n      tableName = this.queryGenerator.addSchema({\r\n        tableName,\r\n        _schema: Boolean(model) && model._schema || options.schema,\r\n      });\r\n    }\r\n\r\n    attributes = this.queryGenerator.attributesToSQL(attributes, { table: tableName, context: 'createTable' });\r\n    sql = this.queryGenerator.createTableQuery(tableName, attributes, options);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Drop a table from database\r\n   *\r\n   * @param {string} tableName Table name to drop\r\n   * @param {object} options   Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropTable(tableName, options) {\r\n    // if we're forcing we should be cascading unless explicitly stated otherwise\r\n    options = { ...options };\r\n    options.cascade = options.cascade || options.force || false;\r\n\r\n    const sql = this.queryGenerator.dropTableQuery(tableName, options);\r\n\r\n    await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async _dropAllTables(tableNames, skip, options) {\r\n    for (const tableName of tableNames) {\r\n      // if tableName is not in the Array of tables names then don't drop it\r\n      if (!skip.includes(tableName.tableName || tableName)) {\r\n        await this.dropTable(tableName, { ...options, cascade: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Drop all tables from database\r\n   *\r\n   * @param {object} [options] query options\r\n   * @param {Array}  [options.skip] List of table to skip\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropAllTables(options) {\r\n    options = options || {};\r\n    const skip = options.skip || [];\r\n\r\n    const tableNames = await this.showAllTables(options);\r\n    const foreignKeys = await this.getForeignKeysForTables(tableNames, options);\r\n\r\n    for (const tableName of tableNames) {\r\n      let normalizedTableName = tableName;\r\n      if (_.isObject(tableName)) {\r\n        normalizedTableName = `${tableName.schema}.${tableName.tableName}`;\r\n      }\r\n\r\n      for (const foreignKey of foreignKeys[normalizedTableName]) {\r\n        await this.sequelize.queryRaw(this.queryGenerator.dropForeignKeyQuery(tableName, foreignKey));\r\n      }\r\n    }\r\n\r\n    await this._dropAllTables(tableNames, skip, options);\r\n  }\r\n\r\n  /**\r\n   * Rename a table\r\n   *\r\n   * @param {string} before    Current name of table\r\n   * @param {string} after     New name from table\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async renameTable(before, after, options) {\r\n    options = options || {};\r\n    const sql = this.queryGenerator.renameTableQuery(before, after);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Get all tables in current database\r\n   *\r\n   * @param {object}    [options] Query options\r\n   * @param {boolean}   [options.raw=true] Run query in raw mode\r\n   * @param {QueryType} [options.type=QueryType.SHOWTABLE] query type\r\n   *\r\n   * @returns {Promise<Array>}\r\n   * @private\r\n   */\r\n  async showAllTables(options) {\r\n    options = {\r\n      ...options,\r\n      raw: true,\r\n      type: QueryTypes.SHOWTABLES,\r\n    };\r\n\r\n    const showTablesSql = this.queryGenerator.showTablesQuery(this.sequelize.config.database);\r\n    const tableNames = await this.sequelize.queryRaw(showTablesSql, options);\r\n\r\n    return tableNames.flat();\r\n  }\r\n\r\n  /**\r\n   * Describe a table structure\r\n   *\r\n   * This method returns an array of hashes containing information about all attributes in the table.\r\n   *\r\n   * ```js\r\n   * {\r\n   *    name: {\r\n   *      type:         'VARCHAR(255)', // this will be 'CHARACTER VARYING' for pg!\r\n   *      allowNull:    true,\r\n   *      defaultValue: null\r\n   *    },\r\n   *    isBetaMember: {\r\n   *      type:         'TINYINT(1)', // this will be 'BOOLEAN' for pg!\r\n   *      allowNull:    false,\r\n   *      defaultValue: false\r\n   *    }\r\n   * }\r\n   * ```\r\n   *\r\n   * @param {string} tableName table name\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise<object>}\r\n   */\r\n  async describeTable(tableName, options) {\r\n    let schema = null;\r\n    let schemaDelimiter = null;\r\n\r\n    if (typeof options === 'string') {\r\n      schema = options;\r\n    } else if (typeof options === 'object' && options !== null) {\r\n      schema = options.schema || null;\r\n      schemaDelimiter = options.schemaDelimiter || null;\r\n    }\r\n\r\n    if (typeof tableName === 'object' && tableName !== null) {\r\n      schema = tableName.schema;\r\n      tableName = tableName.tableName;\r\n    }\r\n\r\n    const sql = this.queryGenerator.describeTableQuery(tableName, schema, schemaDelimiter);\r\n    options = { ...options, type: QueryTypes.DESCRIBE };\r\n\r\n    try {\r\n      const data = await this.sequelize.queryRaw(sql, options);\r\n      /*\r\n       * If no data is returned from the query, then the table name may be wrong.\r\n       * Query generators that use information_schema for retrieving table info will just return an empty result set,\r\n       * it will not throw an error like built-ins do (e.g. DESCRIBE on MySql).\r\n       */\r\n      if (_.isEmpty(data)) {\r\n        throw new Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      if (error.original && error.original.code === 'ER_NO_SUCH_TABLE') {\r\n        throw new Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\r\n      }\r\n\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a new column to a table\r\n   *\r\n   * ```js\r\n   * queryInterface.addColumn('tableA', 'columnC', DataTypes.STRING, {\r\n   *    after: 'columnB' // after option is only supported by MySQL\r\n   * });\r\n   * ```\r\n   *\r\n   * @param {string} table     Table to add column to\r\n   * @param {string} key       Column name\r\n   * @param {object} attribute Attribute definition\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async addColumn(table, key, attribute, options) {\r\n    if (!table || !key || !attribute) {\r\n      throw new Error('addColumn takes at least 3 arguments (table, attribute name, attribute definition)');\r\n    }\r\n\r\n    options = options || {};\r\n    attribute = this.sequelize.normalizeAttribute(attribute);\r\n\r\n    return await this.sequelize.queryRaw(this.queryGenerator.addColumnQuery(table, key, attribute), options);\r\n  }\r\n\r\n  /**\r\n   * Remove a column from a table\r\n   *\r\n   * @param {string} tableName      Table to remove column from\r\n   * @param {string} attributeName  Column name to remove\r\n   * @param {object} [options]      Query options\r\n   */\r\n  async removeColumn(tableName, attributeName, options) {\r\n    return this.sequelize.queryRaw(this.queryGenerator.removeColumnQuery(tableName, attributeName), options);\r\n  }\r\n\r\n  normalizeAttribute(dataTypeOrOptions) {\r\n    let attribute;\r\n    if (Object.values(DataTypes).includes(dataTypeOrOptions)) {\r\n      attribute = { type: dataTypeOrOptions, allowNull: true };\r\n    } else {\r\n      attribute = dataTypeOrOptions;\r\n    }\r\n\r\n    return this.sequelize.normalizeAttribute(attribute);\r\n  }\r\n\r\n  /**\r\n   * Split a list of identifiers by \".\" and quote each part\r\n   *\r\n   * @param {string} identifier\r\n   * @param {boolean} force\r\n   *\r\n   * @returns {string}\r\n   */\r\n  quoteIdentifier(identifier, force) {\r\n    return this.queryGenerator.quoteIdentifier(identifier, force);\r\n  }\r\n\r\n  /**\r\n   * Split a list of identifiers by \".\" and quote each part.\r\n   *\r\n   * @param {string} identifiers\r\n   *\r\n   * @returns {string}\r\n   */\r\n  quoteIdentifiers(identifiers) {\r\n    return this.queryGenerator.quoteIdentifiers(identifiers);\r\n  }\r\n\r\n  /**\r\n   * Change a column definition\r\n   *\r\n   * @param {string} tableName          Table name to change from\r\n   * @param {string} attributeName      Column name\r\n   * @param {object} dataTypeOrOptions  Attribute definition for new column\r\n   * @param {object} [options]          Query options\r\n   */\r\n  async changeColumn(tableName, attributeName, dataTypeOrOptions, options) {\r\n    options = options || {};\r\n\r\n    const query = this.queryGenerator.attributesToSQL({\r\n      [attributeName]: this.normalizeAttribute(dataTypeOrOptions),\r\n    }, {\r\n      context: 'changeColumn',\r\n      table: tableName,\r\n    });\r\n    const sql = this.queryGenerator.changeColumnQuery(tableName, query);\r\n\r\n    return this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Rejects if the table doesn't have the specified column, otherwise returns the column description.\r\n   *\r\n   * @param {string} tableName\r\n   * @param {string} columnName\r\n   * @param {object} options\r\n   * @private\r\n   */\r\n  async assertTableHasColumn(tableName, columnName, options) {\r\n    const description = await this.describeTable(tableName, options);\r\n    if (description[columnName]) {\r\n      return description;\r\n    }\r\n\r\n    throw new Error(`Table ${tableName} doesn't have the column ${columnName}`);\r\n  }\r\n\r\n  /**\r\n   * Rename a column\r\n   *\r\n   * @param {string} tableName        Table name whose column to rename\r\n   * @param {string} attrNameBefore   Current column name\r\n   * @param {string} attrNameAfter    New column name\r\n   * @param {object} [options]        Query option\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async renameColumn(tableName, attrNameBefore, attrNameAfter, options) {\r\n    options = options || {};\r\n    const data = (await this.assertTableHasColumn(tableName, attrNameBefore, options))[attrNameBefore];\r\n\r\n    const _options = {};\r\n\r\n    _options[attrNameAfter] = {\r\n      attribute: attrNameAfter,\r\n      type: data.type,\r\n      allowNull: data.allowNull,\r\n      defaultValue: data.defaultValue,\r\n    };\r\n\r\n    // fix: a not-null column cannot have null as default value\r\n    if (data.defaultValue === null && !data.allowNull) {\r\n      delete _options[attrNameAfter].defaultValue;\r\n    }\r\n\r\n    const sql = this.queryGenerator.renameColumnQuery(\r\n      tableName,\r\n      attrNameBefore,\r\n      this.queryGenerator.attributesToSQL(_options),\r\n    );\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Add an index to a column\r\n   *\r\n   * @param {string|object}  tableName Table name to add index on, can be a object with schema\r\n   * @param {Array}   [attributes]     Use options.fields instead, List of attributes to add index on\r\n   * @param {object}  options          indexes options\r\n   * @param {Array}   options.fields   List of attributes to add index on\r\n   * @param {boolean} [options.concurrently] Pass CONCURRENT so other operations run while the index is created\r\n   * @param {boolean} [options.unique] Create a unique index\r\n   * @param {string}  [options.using]  Useful for GIN indexes\r\n   * @param {string}  [options.operator] Index operator\r\n   * @param {string}  [options.type]   Type of index, available options are UNIQUE|FULLTEXT|SPATIAL\r\n   * @param {string}  [options.name]   Name of the index. Default is <table>_<attr1>_<attr2>\r\n   * @param {object}  [options.where]  Where condition on index, for partial indexes\r\n   * @param {string}  [rawTablename]   table name, this is just for backward compatibiity\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async addIndex(tableName, attributes, options, rawTablename) {\r\n    // Support for passing tableName, attributes, options or tableName, options (with a fields param which is the attributes)\r\n    if (!Array.isArray(attributes)) {\r\n      rawTablename = options;\r\n      options = attributes;\r\n      attributes = options.fields;\r\n    }\r\n\r\n    if (!rawTablename) {\r\n      // Map for backwards compat\r\n      rawTablename = tableName;\r\n    }\r\n\r\n    options = Utils.cloneDeep(options);\r\n    options.fields = attributes;\r\n    const sql = this.queryGenerator.addIndexQuery(tableName, options, rawTablename);\r\n\r\n    return await this.sequelize.queryRaw(sql, { ...options, supportsSearchPath: false });\r\n  }\r\n\r\n  /**\r\n   * Show indexes on a table\r\n   *\r\n   * @param {string} tableName table name\r\n   * @param {object} [options]   Query options\r\n   *\r\n   * @returns {Promise<Array>}\r\n   * @private\r\n   */\r\n  async showIndex(tableName, options) {\r\n    const sql = this.queryGenerator.showIndexesQuery(tableName, options);\r\n\r\n    return await this.sequelize.queryRaw(sql, { ...options, type: QueryTypes.SHOWINDEXES });\r\n  }\r\n\r\n  /**\r\n   * Returns all foreign key constraints of requested tables\r\n   *\r\n   * @param {string[]} tableNames table names\r\n   * @param {object} [options] Query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async getForeignKeysForTables(tableNames, options) {\r\n    if (tableNames.length === 0) {\r\n      return {};\r\n    }\r\n\r\n    options = { ...options, type: QueryTypes.FOREIGNKEYS };\r\n\r\n    const results = await Promise.all(tableNames.map(tableName => this.sequelize.queryRaw(this.queryGenerator.getForeignKeysQuery(tableName, this.sequelize.config.database), options)));\r\n\r\n    const result = {};\r\n\r\n    for (let [i, tableName] of tableNames.entries()) {\r\n      if (_.isObject(tableName)) {\r\n        tableName = `${tableName.schema}.${tableName.tableName}`;\r\n      }\r\n\r\n      result[tableName] = Array.isArray(results[i])\r\n        ? results[i].map(r => r.constraint_name)\r\n        : [results[i] && results[i].constraint_name];\r\n\r\n      result[tableName] = result[tableName].filter(_.identity);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Get foreign key references details for the table\r\n   *\r\n   * Those details contains constraintSchema, constraintName, constraintCatalog\r\n   * tableCatalog, tableSchema, tableName, columnName,\r\n   * referencedTableCatalog, referencedTableCatalog, referencedTableSchema, referencedTableName, referencedColumnName.\r\n   * Remind: constraint informations won't return if it's sqlite.\r\n   *\r\n   * @param {string} tableName table name\r\n   * @param {object} [options]  Query options\r\n   */\r\n  async getForeignKeyReferencesForTable(tableName, options) {\r\n    const queryOptions = {\r\n      ...options,\r\n      type: QueryTypes.FOREIGNKEYS,\r\n    };\r\n    const query = this.queryGenerator.getForeignKeysQuery(tableName, this.sequelize.config.database);\r\n\r\n    return this.sequelize.queryRaw(query, queryOptions);\r\n  }\r\n\r\n  /**\r\n   * Remove an already existing index from a table\r\n   *\r\n   * @param {string} tableName                    Table name to drop index from\r\n   * @param {string|string[]} indexNameOrAttributes  Index name or list of attributes that in the index\r\n   * @param {object} [options]                    Query options\r\n   * @param {boolean} [options.concurrently]      Pass CONCURRENTLY so other operations run while the index is created\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async removeIndex(tableName, indexNameOrAttributes, options) {\r\n    options = options || {};\r\n    const sql = this.queryGenerator.removeIndexQuery(tableName, indexNameOrAttributes, options);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Add a constraint to a table\r\n   *\r\n   * Available constraints:\r\n   * - UNIQUE\r\n   * - DEFAULT (MSSQL only)\r\n   * - CHECK (MySQL - Ignored by the database engine )\r\n   * - FOREIGN KEY\r\n   * - PRIMARY KEY\r\n   *\r\n   * @example <caption>UNIQUE</caption>\r\n   * queryInterface.addConstraint('Users', {\r\n   *   fields: ['email'],\r\n   *   type: 'unique',\r\n   *   name: 'custom_unique_constraint_name'\r\n   * });\r\n   *\r\n   * @example <caption>CHECK</caption>\r\n   * queryInterface.addConstraint('Users', {\r\n   *   fields: ['roles'],\r\n   *   type: 'check',\r\n   *   where: {\r\n   *      roles: ['user', 'admin', 'moderator', 'guest']\r\n   *   }\r\n   * });\r\n   *\r\n   * @example <caption>Default - MSSQL only</caption>\r\n   * queryInterface.addConstraint('Users', {\r\n   *    fields: ['roles'],\r\n   *    type: 'default',\r\n   *    defaultValue: 'guest'\r\n   * });\r\n   *\r\n   * @example <caption>Primary Key</caption>\r\n   * queryInterface.addConstraint('Users', {\r\n   *    fields: ['username'],\r\n   *    type: 'primary key',\r\n   *    name: 'custom_primary_constraint_name'\r\n   * });\r\n   *\r\n   * @example <caption>Foreign Key</caption>\r\n   * queryInterface.addConstraint('Posts', {\r\n   *   fields: ['username'],\r\n   *   type: 'foreign key',\r\n   *   name: 'custom_fkey_constraint_name',\r\n   *   references: { //Required field\r\n   *     table: 'target_table_name',\r\n   *     field: 'target_column_name'\r\n   *   },\r\n   *   onDelete: 'cascade',\r\n   *   onUpdate: 'cascade'\r\n   * });\r\n   *\r\n   * @example <caption>Composite Foreign Key</caption>\r\n   * queryInterface.addConstraint('TableName', {\r\n   *   fields: ['source_column_name', 'other_source_column_name'],\r\n   *   type: 'foreign key',\r\n   *   name: 'custom_fkey_constraint_name',\r\n   *   references: { //Required field\r\n   *     table: 'target_table_name',\r\n   *     fields: ['target_column_name', 'other_target_column_name']\r\n   *   },\r\n   *   onDelete: 'cascade',\r\n   *   onUpdate: 'cascade'\r\n   * });\r\n   *\r\n   * @param {string} tableName                   Table name where you want to add a constraint\r\n   * @param {object} options                     An object to define the constraint name, type etc\r\n   * @param {string} options.type                Type of constraint. One of the values in available constraints(case insensitive)\r\n   * @param {Array}  options.fields              Array of column names to apply the constraint over\r\n   * @param {string} [options.name]              Name of the constraint. If not specified, sequelize automatically creates a named constraint based on constraint type, table & column names\r\n   * @param {string} [options.defaultValue]      The value for the default constraint\r\n   * @param {object} [options.where]             Where clause/expression for the CHECK constraint\r\n   * @param {object} [options.references]        Object specifying target table, column name to create foreign key constraint\r\n   * @param {string} [options.references.table]  Target table name\r\n   * @param {string} [options.references.field]  Target column name\r\n   * @param {string} [options.references.fields] Target column names for a composite primary key. Must match the order of fields in options.fields.\r\n   * @param {string} [options.deferrable]        Sets the constraint to be deferred or immediately checked. See Sequelize.Deferrable. PostgreSQL Only\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async addConstraint(tableName, options) {\r\n    if (!options.fields) {\r\n      throw new Error('Fields must be specified through options.fields');\r\n    }\r\n\r\n    if (!options.type) {\r\n      throw new Error('Constraint type must be specified through options.type');\r\n    }\r\n\r\n    options = Utils.cloneDeep(options);\r\n\r\n    const sql = this.queryGenerator.addConstraintQuery(tableName, options);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async showConstraint(tableName, constraintName, options) {\r\n    const sql = this.queryGenerator.showConstraintsQuery(tableName, constraintName);\r\n\r\n    return await this.sequelize.queryRaw(sql, { ...options, type: QueryTypes.SHOWCONSTRAINTS });\r\n  }\r\n\r\n  /**\r\n   * Remove a constraint from a table\r\n   *\r\n   * @param {string} tableName       Table name to drop constraint from\r\n   * @param {string} constraintName  Constraint name\r\n   * @param {object} options         Query options\r\n   */\r\n  async removeConstraint(tableName, constraintName, options) {\r\n    return this.sequelize.queryRaw(this.queryGenerator.removeConstraintQuery(tableName, constraintName), options);\r\n  }\r\n\r\n  async insert(instance, tableName, values, options) {\r\n    if (options?.bind) {\r\n      assertNoReservedBind(options.bind);\r\n    }\r\n\r\n    options = Utils.cloneDeep(options);\r\n    options.hasTrigger = instance && instance.constructor.options.hasTrigger;\r\n    const { query, bind } = this.queryGenerator.insertQuery(tableName, values, instance && instance.constructor.rawAttributes, options);\r\n\r\n    options.type = QueryTypes.INSERT;\r\n    options.instance = instance;\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n    options.bind = combineBinds(options.bind, bind);\r\n\r\n    const results = await this.sequelize.queryRaw(query, options);\r\n    if (instance) {\r\n      results[0].isNewRecord = false;\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Upsert\r\n   *\r\n   * @param {string} tableName    table to upsert on\r\n   * @param {object} insertValues values to be inserted, mapped to field name\r\n   * @param {object} updateValues values to be updated, mapped to field name\r\n   * @param {object} where        where conditions, which can be used for UPDATE part when INSERT fails\r\n   * @param {object} options      query options\r\n   *\r\n   * @returns {Promise<boolean,?number>} Resolves an array with <created, primaryKey>\r\n   */\r\n  async upsert(tableName, insertValues, updateValues, where, options) {\r\n    if (options?.bind) {\r\n      assertNoReservedBind(options.bind);\r\n    }\r\n\r\n    options = { ...options };\r\n\r\n    const model = options.model;\r\n\r\n    options.type = QueryTypes.UPSERT;\r\n    options.updateOnDuplicate = Object.keys(updateValues);\r\n    options.upsertKeys = options.conflictFields || [];\r\n\r\n    if (options.upsertKeys.length === 0) {\r\n      const primaryKeys = Object.values(model.primaryKeys).map(item => item.field);\r\n      const uniqueKeys = Object.values(model.uniqueKeys).filter(c => c.fields.length > 0).map(c => c.fields);\r\n      const indexKeys = Object.values(model._indexes).filter(c => c.unique && c.fields.length > 0).map(c => c.fields);\r\n      // For fields in updateValues, try to find a constraint or unique index\r\n      // that includes given field. Only first matching upsert key is used.\r\n      for (const field of options.updateOnDuplicate) {\r\n        const uniqueKey = uniqueKeys.find(fields => fields.includes(field));\r\n        if (uniqueKey) {\r\n          options.upsertKeys = uniqueKey;\r\n          break;\r\n        }\r\n\r\n        const indexKey = indexKeys.find(fields => fields.includes(field));\r\n        if (indexKey) {\r\n          options.upsertKeys = indexKey;\r\n          break;\r\n        }\r\n      }\r\n\r\n      // Always use PK, if no constraint available OR update data contains PK\r\n      if (\r\n        options.upsertKeys.length === 0\r\n        || _.intersection(options.updateOnDuplicate, primaryKeys).length > 0\r\n      ) {\r\n        options.upsertKeys = primaryKeys;\r\n      }\r\n\r\n      options.upsertKeys = _.uniq(options.upsertKeys);\r\n    }\r\n\r\n    const { bind, query } = this.queryGenerator.insertQuery(tableName, insertValues, model.rawAttributes, options);\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacement;\r\n    options.bind = combineBinds(options.bind, bind);\r\n\r\n    return await this.sequelize.queryRaw(query, options);\r\n  }\r\n\r\n  /**\r\n   * Insert multiple records into a table\r\n   *\r\n   * @example\r\n   * queryInterface.bulkInsert('roles', [{\r\n   *    label: 'user',\r\n   *    createdAt: new Date(),\r\n   *    updatedAt: new Date()\r\n   *  }, {\r\n   *    label: 'admin',\r\n   *    createdAt: new Date(),\r\n   *    updatedAt: new Date()\r\n   *  }]);\r\n   *\r\n   * @param {string} tableName   Table name to insert record to\r\n   * @param {Array}  records     List of records to insert\r\n   * @param {object} options     Various options, please see Model.bulkCreate options\r\n   * @param {object} attributes  Various attributes mapped by field name\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async bulkInsert(tableName, records, options, attributes) {\r\n    options = { ...options, type: QueryTypes.INSERT };\r\n\r\n    const sql = this.queryGenerator.bulkInsertQuery(tableName, records, options, attributes);\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    const results = await this.sequelize.queryRaw(sql, options);\r\n\r\n    return results[0];\r\n  }\r\n\r\n  async update(instance, tableName, values, where, options) {\r\n    if (options?.bind) {\r\n      assertNoReservedBind(options.bind);\r\n    }\r\n\r\n    options = { ...options };\r\n    options.hasTrigger = instance && instance.constructor.options.hasTrigger;\r\n\r\n    const { query, bind } = this.queryGenerator.updateQuery(tableName, values, where, options, instance.constructor.rawAttributes);\r\n\r\n    options.type = QueryTypes.UPDATE;\r\n    options.instance = instance;\r\n\r\n    delete options.replacements;\r\n\r\n    options.bind = combineBinds(options.bind, bind);\r\n\r\n    return await this.sequelize.queryRaw(query, options);\r\n  }\r\n\r\n  /**\r\n   * Update multiple records of a table\r\n   *\r\n   * @example\r\n   * queryInterface.bulkUpdate('roles', {\r\n   *     label: 'admin',\r\n   *   }, {\r\n   *     userType: 3,\r\n   *   },\r\n   * );\r\n   *\r\n   * @param {string} tableName     Table name to update\r\n   * @param {object} values        Values to be inserted, mapped to field name\r\n   * @param {object} where    A hash with conditions OR an ID as integer OR a string with conditions\r\n   * @param {object} [options]     Various options, please see Model.bulkCreate options\r\n   * @param {object} [columnDefinitions]  Attributes on return objects if supported by SQL dialect\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async bulkUpdate(tableName, values, where, options, columnDefinitions) {\r\n    if (options?.bind) {\r\n      assertNoReservedBind(options.bind);\r\n    }\r\n\r\n    options = Utils.cloneDeep(options);\r\n    if (typeof where === 'object') {\r\n      where = Utils.cloneDeep(where);\r\n    }\r\n\r\n    const { bind, query } = this.queryGenerator.updateQuery(tableName, values, where, options, columnDefinitions);\r\n    const table = _.isObject(tableName) ? tableName : { tableName };\r\n    const model = _.find(this.sequelize.modelManager.models, { tableName: table.tableName });\r\n\r\n    options.type = QueryTypes.BULKUPDATE;\r\n    options.model = model;\r\n    options.bind = combineBinds(options.bind, bind);\r\n\r\n    return await this.sequelize.queryRaw(query, options);\r\n  }\r\n\r\n  async delete(instance, tableName, identifier, options) {\r\n    const cascades = [];\r\n\r\n    const sql = this.queryGenerator.deleteQuery(tableName, identifier, {}, instance.constructor);\r\n\r\n    options = { ...options };\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    // Check for a restrict field\r\n    if (Boolean(instance.constructor) && Boolean(instance.constructor.associations)) {\r\n      const keys = Object.keys(instance.constructor.associations);\r\n      const length = keys.length;\r\n      let association;\r\n\r\n      for (let i = 0; i < length; i++) {\r\n        association = instance.constructor.associations[keys[i]];\r\n        if (association.options && association.options.onDelete\r\n          && association.options.onDelete.toLowerCase() === 'cascade'\r\n          && association.options.hooks === true) {\r\n          cascades.push(association.accessors.get);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const cascade of cascades) {\r\n      let instances = await instance[cascade](options);\r\n      // Check for hasOne relationship with non-existing associate (\"has zero\")\r\n      if (!instances) {\r\n        continue;\r\n      }\r\n\r\n      if (!Array.isArray(instances)) {\r\n        instances = [instances];\r\n      }\r\n\r\n      for (const _instance of instances) {\r\n        await _instance.destroy(options);\r\n      }\r\n    }\r\n\r\n    options.instance = instance;\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  /**\r\n   * Delete multiple records from a table\r\n   *\r\n   * @param {string}  tableName            table name from where to delete records\r\n   * @param {object}  where                where conditions to find records to delete\r\n   * @param {object}  [options]            options\r\n   * @param {boolean} [options.truncate]   Use truncate table command\r\n   * @param {boolean} [options.cascade=false]         Only used in conjunction with TRUNCATE. Truncates  all tables that have foreign-key references to the named table, or to any tables added to the group due to CASCADE.\r\n   * @param {boolean} [options.restartIdentity=false] Only used in conjunction with TRUNCATE. Automatically restart sequences owned by columns of the truncated table.\r\n   * @param {Model}   [model]              Model\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async bulkDelete(tableName, where, options, model) {\r\n    options = Utils.cloneDeep(options);\r\n    options = _.defaults(options, { limit: null });\r\n\r\n    if (options.truncate === true) {\r\n      return this.sequelize.queryRaw(\r\n        this.queryGenerator.truncateTableQuery(tableName, options),\r\n        options,\r\n      );\r\n    }\r\n\r\n    if (typeof identifier === 'object') {\r\n      where = Utils.cloneDeep(where);\r\n    }\r\n\r\n    const sql = this.queryGenerator.deleteQuery(tableName, where, options, model);\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    return await this.sequelize.queryRaw(\r\n      sql,\r\n      options,\r\n    );\r\n  }\r\n\r\n  async select(model, tableName, optionsArg) {\r\n    const options = { ...optionsArg, type: QueryTypes.SELECT, model };\r\n\r\n    const sql = this.queryGenerator.selectQuery(tableName, options, model);\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async increment(model, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options) {\r\n    return this.#arithmeticQuery('+', model, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options);\r\n  }\r\n\r\n  async decrement(model, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options) {\r\n    return this.#arithmeticQuery('-', model, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options);\r\n  }\r\n\r\n  async #arithmeticQuery(operator, model, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options) {\r\n    options = Utils.cloneDeep(options);\r\n    options.model = model;\r\n\r\n    const sql = this.queryGenerator.arithmeticQuery(operator, tableName, where, incrementAmountsByField, extraAttributesToBeUpdated, options);\r\n\r\n    options.type = QueryTypes.UPDATE;\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async rawSelect(tableName, options, attributeSelector, Model) {\r\n    options = Utils.cloneDeep(options);\r\n    options = _.defaults(options, {\r\n      raw: true,\r\n      plain: true,\r\n      type: QueryTypes.SELECT,\r\n    });\r\n\r\n    const sql = this.queryGenerator.selectQuery(tableName, options, Model);\r\n\r\n    if (attributeSelector === undefined) {\r\n      throw new Error('Please pass an attribute selector!');\r\n    }\r\n\r\n    // unlike bind, replacements are handled by QueryGenerator, not QueryRaw\r\n    delete options.replacements;\r\n\r\n    const data = await this.sequelize.queryRaw(sql, options);\r\n    if (!options.plain) {\r\n      return data;\r\n    }\r\n\r\n    const result = data ? data[attributeSelector] : null;\r\n\r\n    if (!options || !options.dataType) {\r\n      return result;\r\n    }\r\n\r\n    const dataType = options.dataType;\r\n\r\n    // TODO: DECIMAL is not safely representable as a float!\r\n    //  Use the DataType's parse method instead.\r\n    if ((dataType instanceof DataTypes.DECIMAL || dataType instanceof DataTypes.FLOAT) && result !== null) {\r\n      return Number.parseFloat(result);\r\n    }\r\n\r\n    // TODO: BIGINT is not safely representable as an int!\r\n    //  Use the DataType's parse method instead.\r\n    if ((dataType instanceof DataTypes.INTEGER || dataType instanceof DataTypes.BIGINT) && result !== null) {\r\n      return Number.parseInt(result, 10);\r\n    }\r\n\r\n    if (dataType instanceof DataTypes.DATE && result !== null && !(result instanceof Date)) {\r\n      return new Date(result);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  async createTrigger(\r\n    tableName,\r\n    triggerName,\r\n    timingType,\r\n    fireOnArray,\r\n    functionName,\r\n    functionParams,\r\n    optionsArray,\r\n    options,\r\n  ) {\r\n    const sql = this.queryGenerator.createTrigger(tableName, triggerName, timingType, fireOnArray, functionName, functionParams, optionsArray);\r\n    options = options || {};\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  async dropTrigger(tableName, triggerName, options) {\r\n    const sql = this.queryGenerator.dropTrigger(tableName, triggerName);\r\n    options = options || {};\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  async renameTrigger(tableName, oldTriggerName, newTriggerName, options) {\r\n    const sql = this.queryGenerator.renameTrigger(tableName, oldTriggerName, newTriggerName);\r\n    options = options || {};\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create an SQL function\r\n   *\r\n   * @example\r\n   * queryInterface.createFunction(\r\n   *   'someFunction',\r\n   *   [\r\n   *     {type: 'integer', name: 'param', direction: 'IN'}\r\n   *   ],\r\n   *   'integer',\r\n   *   'plpgsql',\r\n   *   'RETURN param + 1;',\r\n   *   [\r\n   *     'IMMUTABLE',\r\n   *     'LEAKPROOF'\r\n   *   ],\r\n   *   {\r\n   *    variables:\r\n   *      [\r\n   *        {type: 'integer', name: 'myVar', default: 100}\r\n   *      ],\r\n   *      force: true\r\n   *   };\r\n   * );\r\n   *\r\n   * @param {string}  functionName  Name of SQL function to create\r\n   * @param {Array}   params        List of parameters declared for SQL function\r\n   * @param {string}  returnType    SQL type of function returned value\r\n   * @param {string}  language      The name of the language that the function is implemented in\r\n   * @param {string}  body          Source code of function\r\n   * @param {Array}   optionsArray  Extra-options for creation\r\n   * @param {object}  [options]     query options\r\n   * @param {boolean} options.force If force is true, any existing functions with the same parameters will be replaced. For postgres, this means using `CREATE OR REPLACE FUNCTION` instead of `CREATE FUNCTION`. Default is false\r\n   * @param {Array<object>}   options.variables List of declared variables. Each variable should be an object with string fields `type` and `name`, and optionally having a `default` field as well.\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async createFunction(functionName, params, returnType, language, body, optionsArray, options) {\r\n    const sql = this.queryGenerator.createFunction(functionName, params, returnType, language, body, optionsArray, options);\r\n    options = options || {};\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Drop an SQL function\r\n   *\r\n   * @example\r\n   * queryInterface.dropFunction(\r\n   *   'someFunction',\r\n   *   [\r\n   *     {type: 'varchar', name: 'param1', direction: 'IN'},\r\n   *     {type: 'integer', name: 'param2', direction: 'INOUT'}\r\n   *   ]\r\n   * );\r\n   *\r\n   * @param {string} functionName Name of SQL function to drop\r\n   * @param {Array}  params       List of parameters declared for SQL function\r\n   * @param {object} [options]    query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async dropFunction(functionName, params, options) {\r\n    const sql = this.queryGenerator.dropFunction(functionName, params);\r\n    options = options || {};\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Rename an SQL function\r\n   *\r\n   * @example\r\n   * queryInterface.renameFunction(\r\n   *   'fooFunction',\r\n   *   [\r\n   *     {type: 'varchar', name: 'param1', direction: 'IN'},\r\n   *     {type: 'integer', name: 'param2', direction: 'INOUT'}\r\n   *   ],\r\n   *   'barFunction'\r\n   * );\r\n   *\r\n   * @param {string} oldFunctionName  Current name of function\r\n   * @param {Array}  params           List of parameters declared for SQL function\r\n   * @param {string} newFunctionName  New name of function\r\n   * @param {object} [options]        query options\r\n   *\r\n   * @returns {Promise}\r\n   */\r\n  async renameFunction(oldFunctionName, params, newFunctionName, options) {\r\n    const sql = this.queryGenerator.renameFunction(oldFunctionName, params, newFunctionName);\r\n    options = options || {};\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  // Helper methods useful for querying\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  ensureEnums() {\r\n    // noop by default\r\n  }\r\n\r\n  async setIsolationLevel(transaction, value, options) {\r\n    if (!transaction || !(transaction instanceof Transaction)) {\r\n      throw new Error('Unable to set isolation level for a transaction without transaction object!');\r\n    }\r\n\r\n    if (transaction.parent || !value) {\r\n      // Not possible to set a separate isolation level for savepoints\r\n      return;\r\n    }\r\n\r\n    options = { ...options, transaction: transaction.parent || transaction };\r\n\r\n    const sql = this.queryGenerator.setIsolationLevelQuery(value, {\r\n      parent: transaction.parent,\r\n    });\r\n\r\n    if (!sql) {\r\n      return;\r\n    }\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async startTransaction(transaction, options) {\r\n    if (!transaction || !(transaction instanceof Transaction)) {\r\n      throw new Error('Unable to start a transaction without transaction object!');\r\n    }\r\n\r\n    options = { ...options, transaction: transaction.parent || transaction };\r\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\r\n    const sql = this.queryGenerator.startTransactionQuery(transaction);\r\n\r\n    return await this.sequelize.queryRaw(sql, options);\r\n  }\r\n\r\n  async deferConstraints(transaction, options) {\r\n    options = { ...options, transaction: transaction.parent || transaction };\r\n\r\n    const sql = this.queryGenerator.deferConstraintsQuery(options);\r\n\r\n    if (sql) {\r\n      return await this.sequelize.queryRaw(sql, options);\r\n    }\r\n  }\r\n\r\n  async commitTransaction(transaction, options) {\r\n    if (!transaction || !(transaction instanceof Transaction)) {\r\n      throw new Error('Unable to commit a transaction without transaction object!');\r\n    }\r\n\r\n    if (transaction.parent) {\r\n      // Savepoints cannot be committed\r\n      return;\r\n    }\r\n\r\n    options = {\r\n      ...options,\r\n      transaction: transaction.parent || transaction,\r\n      supportsSearchPath: false,\r\n      completesTransaction: true,\r\n    };\r\n\r\n    const sql = this.queryGenerator.commitTransactionQuery(transaction);\r\n    const promise = this.sequelize.queryRaw(sql, options);\r\n\r\n    transaction.finished = 'commit';\r\n\r\n    return await promise;\r\n  }\r\n\r\n  async rollbackTransaction(transaction, options) {\r\n    if (!transaction || !(transaction instanceof Transaction)) {\r\n      throw new Error('Unable to rollback a transaction without transaction object!');\r\n    }\r\n\r\n    options = {\r\n      ...options,\r\n      transaction: transaction.parent || transaction,\r\n      supportsSearchPath: false,\r\n      completesTransaction: true,\r\n    };\r\n    options.transaction.name = transaction.parent ? transaction.name : undefined;\r\n    const sql = this.queryGenerator.rollbackTransactionQuery(transaction);\r\n    const promise = this.sequelize.queryRaw(sql, options);\r\n\r\n    transaction.finished = 'rollback';\r\n\r\n    return await promise;\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
