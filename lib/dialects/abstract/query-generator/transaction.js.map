{
  "version": 3,
  "sources": ["../../../../src/dialects/abstract/query-generator/transaction.js"],
  "sourcesContent": ["'use strict';\r\n\r\nconst uuidv4 = require('uuid').v4;\r\n\r\nconst TransactionQueries = {\r\n  /**\r\n   * Returns a query that sets the transaction isolation level.\r\n   *\r\n   * @param  {string} value   The isolation level.\r\n   * @param  {object} options An object with options.\r\n   * @returns {string}         The generated sql query.\r\n   * @private\r\n   */\r\n  setIsolationLevelQuery(value, options) {\r\n    if (options.parent) {\r\n      return;\r\n    }\r\n\r\n    return `SET TRANSACTION ISOLATION LEVEL ${value};`;\r\n  },\r\n\r\n  generateTransactionId() {\r\n    return uuidv4();\r\n  },\r\n\r\n  /**\r\n   * Returns a query that starts a transaction.\r\n   *\r\n   * @param  {Transaction} transaction\r\n   * @returns {string}         The generated sql query.\r\n   * @private\r\n   */\r\n  startTransactionQuery(transaction) {\r\n    if (transaction.parent) {\r\n      // force quoting of savepoint identifiers for postgres\r\n      return `SAVEPOINT ${this.quoteIdentifier(transaction.name, true)};`;\r\n    }\r\n\r\n    return 'START TRANSACTION;';\r\n  },\r\n\r\n  deferConstraintsQuery() {},\r\n\r\n  setConstraintQuery() {},\r\n  setDeferredQuery() {},\r\n  setImmediateQuery() {},\r\n\r\n  /**\r\n   * Returns a query that commits a transaction.\r\n   *\r\n   * @param  {Transaction} transaction An object with options.\r\n   * @returns {string}         The generated sql query.\r\n   * @private\r\n   */\r\n  commitTransactionQuery(transaction) {\r\n    if (transaction.parent) {\r\n      return;\r\n    }\r\n\r\n    return 'COMMIT;';\r\n  },\r\n\r\n  /**\r\n   * Returns a query that rollbacks a transaction.\r\n   *\r\n   * @param  {Transaction} transaction\r\n   * @returns {string}         The generated sql query.\r\n   * @private\r\n   */\r\n  rollbackTransactionQuery(transaction) {\r\n    if (transaction.parent) {\r\n      // force quoting of savepoint identifiers for postgres\r\n      return `ROLLBACK TO SAVEPOINT ${this.quoteIdentifier(transaction.name, true)};`;\r\n    }\r\n\r\n    return 'ROLLBACK;';\r\n  },\r\n};\r\n\r\nmodule.exports = TransactionQueries;\r\n"],
  "mappings": ";AAEA,MAAM,SAAS,QAAQ,MAAM,EAAE;AAE/B,MAAM,qBAAqB;AAAA,EASzB,uBAAuB,OAAO,SAAS;AACrC,QAAI,QAAQ,QAAQ;AAClB;AAAA,IACF;AAEA,WAAO,mCAAmC;AAAA,EAC5C;AAAA,EAEA,wBAAwB;AACtB,WAAO,OAAO;AAAA,EAChB;AAAA,EASA,sBAAsB,aAAa;AACjC,QAAI,YAAY,QAAQ;AAEtB,aAAO,aAAa,KAAK,gBAAgB,YAAY,MAAM,IAAI;AAAA,IACjE;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,wBAAwB;AAAA,EAAC;AAAA,EAEzB,qBAAqB;AAAA,EAAC;AAAA,EACtB,mBAAmB;AAAA,EAAC;AAAA,EACpB,oBAAoB;AAAA,EAAC;AAAA,EASrB,uBAAuB,aAAa;AAClC,QAAI,YAAY,QAAQ;AACtB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EASA,yBAAyB,aAAa;AACpC,QAAI,YAAY,QAAQ;AAEtB,aAAO,yBAAyB,KAAK,gBAAgB,YAAY,MAAM,IAAI;AAAA,IAC7E;AAEA,WAAO;AAAA,EACT;AACF;AAEA,OAAO,UAAU;",
  "names": []
}
